#!/usr/bin/env python
# File created on 29 Apr 2012
from __future__ import division

__author__ = "Antonio Gonzalez Pena"
__copyright__ = "Copyright 2011-2013, The Platypus Project"
__credits__ = ["Antonio Gonzalez Pena", "Yoshiki Vazquez Baeza"]
__license__ = "GPL"
__version__ = "0.0.8-dev"
__maintainer__ = "Antonio Gonzalez Pena"
__email__ = "antgonza@gmail.com"
__status__ = "Development"

from StringIO import StringIO 
from platypus.parse import (parse_first_database, parse_second_database,
    process_results)

from cogent.util.unit_test import TestCase, main

class TopLevelTests(TestCase):
    """ Tests of compare blast databases code """

    def setUp(self):
        self.db1 = StringIO(FIRST_DB)
        self.db2 = StringIO(SECOND_DB)

    def test_parse_first_database(self):
        """Parse first db should build best_hits correctly"""

        out_total_queries, out_best_hits = parse_first_database(self.db1, [.80],
            [50])
        self.assertEquals(out_total_queries, 2)
        self.assertEquals(out_best_hits, {'HABJ36W02EXF44': [{'a':
            {'evalue': 0.0, 'subject_id': 'NZ_ABEH01000018_641736102',
            'bit_score': 1005.0, 'percentage_id': 99.42, 'alg_length': 519},
            'b': {'subject_id': None, 'bit_score': -1}}], 'HABJ36W02DLDSY': [
            {'a': {'evalue': 0.0, 'subject_id': 'NZ_ABEH01000005_641736102',
            'bit_score': 959.0, 'percentage_id': 99.22, 'alg_length': 512},
            'b': {'subject_id': None, 'bit_score': -1}}]})

    def test_parse_second_database(self):
        """Check the second database is parsed correctly & updates best_hits"""
        best_hits = {'HABJ36W02EXF44': [{'a': {'evalue': 0.0,
            'subject_id': 'NZ_ABEH01000018_641736102', 'bit_score': 1005.0,
            'percentage_id': 99.42, 'alg_length': 519}, 'b': {'subject_id':
            None, 'bit_score': -1}}], 'HABJ36W02DLDSY': [{'a': {'evalue': 0.0,
            'subject_id': 'NZ_ABEH01000005_641736102', 'bit_score': 959.0,
            'percentage_id': 99.22, 'alg_length': 512}, 'b': {'subject_id':
            None, 'bit_score': -1}}]}

        parse_second_database(self.db2, best_hits, [0.30], [30])
        self.assertEquals(best_hits, {'HABJ36W02EXF44': [{'a': {'evalue': 0.0,
            'bit_score': 1005.0, 'subject_id': 'NZ_ABEH01000018_641736102',
            'alg_length': 519, 'percentage_id': 99.42}, 'b': {'evalue': 4.6,
            'subject_id': 'NC_013421_646311947', 'bit_score': 40.1,
            'percentage_id': 90.62, 'alg_length': 32}}], 'HABJ36W02DLDSY':
            [{'a': {'evalue': 0.0, 'bit_score': 959.0, 'subject_id':
            'NZ_ABEH01000005_641736102', 'alg_length': 512, 'percentage_id':
            99.22}, 'b': {'evalue': 4e-133, 'subject_id':
            'NZ_ACZD01000120_647000262', 'bit_score': 482.0, 'percentage_id':
            88.79, 'alg_length': 455}}]})

    def test_process_results(self):
        """Check results are processed and summarized correctly"""
        best_hits = {'HABJ36W02EXF44': [{'a': {'evalue': 0.0,
            'subject_id': 'NZ_ABEH01000018_641736102', 'bit_score': 1005.0,
            'percentage_id': 99.42, 'alg_length': 519}, 'b': {'subject_id':
            None, 'bit_score': -1}}], 'HABJ36W02DLDSY': [{'a': {'evalue': 0.0,
            'subject_id': 'NZ_ABEH01000005_641736102', 'bit_score': 959.0,
            'percentage_id': 99.22, 'alg_length': 512}, 'b': {'subject_id':
            None, 'bit_score': -1}}]}

        out_results = process_results([0.80], [50], [0.30], [30], best_hits)
        self.assertEquals(out_results, [{'db_interest': 0, 'db_other': 0,
            'db_seqs_counts': {'a': {'NZ_ABEH01000005_641736102': 1,
            'NZ_ABEH01000018_641736102': 1}, 'b': {None: 0}},
            'perfect_interest': 2, 'equal': 0, 'summary':
            ['#SeqId\tFirst\tSecond',
            'HABJ36W02EXF44\tNZ_ABEH01000018_641736102\t',
            'HABJ36W02DLDSY\tNZ_ABEH01000005_641736102\t'],
            'filename': 'p1_0-a1_50_p2_0-a2_30'}])


FIRST_DB = """# BLASTN 2.2.22 [Sep-27-2009]
# Query: HABJ36W02EXF44
# Database: Salmonella.contig.fna
# Fields: Query id, Subject id, % identity, alignment length, mismatches, gap openings, q. start, q. end, s. start, s. end, e-value, bit score
HABJ36W02EXF44	NZ_ABEH01000018_641736102	99.42	519	3	0	15	533	28447	27929	0.0	1005
HABJ36W02EXF44	NZ_ABFF01000031_641736209	98.83	515	6	0	19	533	15133	15647	0.0	 973
HABJ36W02EXF44	NC_011094_642555159	98.64	515	7	0	19	533	2781165	2780651	0.0	 965
HABJ36W02EXF44	NC_011094_642555159	92.00	25	2	0	219	243	2785084	2785060	5.8	34.2
HABJ36W02EXF44	NZ_ABEJ01000031_641736100	98.64	515	7	0	19	533	26411	25897	0.0	 965
HABJ36W02EXF44	NZ_ABEJ01000031_641736100	92.00	25	2	0	219	243	30330	30306	5.8	34.2
HABJ36W02EXF44	NZ_ACBF01000001_645058837	98.06	515	10	0	19	533	26633	26119	0.0	 942
HABJ36W02EXF44	NZ_ACBF01000001_645058837	92.00	25	2	0	219	243	30552	30528	5.8	34.2
HABJ36W02EXF44	NC_011083_642555156	98.06	515	10	0	19	533	2836764	2836250	0.0	 942
HABJ36W02EXF44	NC_011149_642555154	98.06	515	10	0	19	533	2771318	2770804	0.0	 942
HABJ36W02EXF44	NC_011149_642555154	92.00	25	2	0	219	243	2775237	2775213	5.8	34.2
HABJ36W02EXF44	NZ_ABAK01000028_641736234	98.06	515	10	0	19	533	27544	27030	0.0	 942
HABJ36W02EXF44	NZ_ABAK01000028_641736234	92.00	25	2	0	219	243	31463	31439	5.8	34.2
HABJ36W02EXF44	NZ_ABAN01000036_641736230	97.88	519	11	0	15	533	15429	15947	0.0	 942
HABJ36W02EXF44	NZ_ABEL01000017_641736105	98.06	515	10	0	19	533	26642	26128	0.0	 942
HABJ36W02EXF44	NZ_ABEI01000027_641736103	98.06	515	10	0	19	533	27197	26683	0.0	 942
HABJ36W02EXF44	NZ_ABEI01000027_641736103	92.00	25	2	0	219	243	31116	31092	5.8	34.2
HABJ36W02EXF44	NC_010102_641228506	98.06	515	10	0	19	533	2842295	2841781	0.0	 942
HABJ36W02EXF44	NC_010102_641228506	92.00	25	2	0	219	243	2846214	2846190	5.8	34.2
HABJ36W02EXF44	NZ_CAAX01000678_642979348	97.69	519	12	0	15	533	13183	13701	0.0	 934
HABJ36W02EXF44	NZ_CAAX01000678_642979348	92.00	25	2	0	219	243	9868	9892	5.8	34.2
HABJ36W02EXF44	NZ_CAAZ01000042_642979346	97.69	519	12	0	15	533	16462	16980	0.0	 934
HABJ36W02EXF44	NZ_CAAZ01000042_642979346	92.00	25	2	0	219	243	13147	13171	5.8	34.2
HABJ36W02EXF44	NZ_CAAR01000177_642979344	97.69	519	12	0	15	533	12986	13504	0.0	 934
HABJ36W02EXF44	NZ_CAAR01000177_642979344	92.00	25	2	0	219	243	9677	9701	5.8	34.2
HABJ36W02EXF44	NZ_CAAS01001136_642979343	97.69	519	12	0	15	533	1487	969	0.0	 934
HABJ36W02EXF44	NZ_CAAT01000036_642979342	97.69	519	12	0	15	533	16463	16981	0.0	 934
HABJ36W02EXF44	NZ_CAAT01000036_642979342	92.00	25	2	0	219	243	13147	13171	5.8	34.2
HABJ36W02EXF44	NZ_CAAW01000933_642979339	97.69	519	12	0	15	533	2172	1654	0.0	 934
HABJ36W02EXF44	NZ_CAAW01000933_642979339	92.00	25	2	0	219	243	5487	5463	5.8	34.2
HABJ36W02EXF44	NC_011147_642555158	97.69	519	12	0	15	533	2641907	2641389	0.0	 934
HABJ36W02EXF44	NC_011147_642555158	92.00	25	2	0	219	243	2645822	2645798	5.8	34.2
HABJ36W02EXF44	NC_003198_637000254	97.69	519	12	0	15	533	2744484	2743966	0.0	 934
HABJ36W02EXF44	NC_003198_637000254	92.00	25	2	0	219	243	2747799	2747775	5.8	34.2
HABJ36W02EXF44	NC_004631_637000253	97.69	519	12	0	15	533	2719709	2719191	0.0	 934
HABJ36W02EXF44	NC_004631_637000253	92.00	25	2	0	219	243	2723024	2723000	5.8	34.2
HABJ36W02EXF44	NC_006511_637000252	97.69	519	12	0	15	533	2646371	2645853	0.0	 934
HABJ36W02EXF44	NC_006511_637000252	92.00	25	2	0	219	243	2650286	2650262	5.8	34.2
HABJ36W02EXF44	NC_012125_643692035	97.50	519	13	0	15	533	2827613	2827095	0.0	 926
HABJ36W02EXF44	NC_012125_643692035	92.00	25	2	0	219	243	2831528	2831504	5.8	34.2
HABJ36W02EXF44	NZ_CAAQ01006338_642979345	97.50	519	12	1	15	533	2091	2608	0.0	 918
HABJ36W02EXF44	NZ_ABFG01000005_641736208	97.48	515	13	0	19	533	329264	329778	0.0	 918
HABJ36W02EXF44	NZ_ABFH01000012_641736185	97.30	519	14	0	15	533	141726	142244	0.0	 918
HABJ36W02EXF44	NC_006905_637000251	97.30	519	13	1	15	533	2845745	2845228	0.0	 910
HABJ36W02EXF44	NC_006905_637000251	92.00	25	2	0	219	243	2849660	2849636	5.8	34.2
HABJ36W02EXF44	CP002614_651053065	96.92	519	16	0	15	533	2830739	2830221	0.0	 902
HABJ36W02EXF44	CP002614_651053065	92.00	25	2	0	219	243	2834654	2834630	5.8	34.2
HABJ36W02EXF44	AP011957_651053064	96.92	519	16	0	15	533	2852135	2851617	0.0	 902
HABJ36W02EXF44	AP011957_651053064	92.00	25	2	0	219	243	2856050	2856026	5.8	34.2
HABJ36W02EXF44	FQ312003_650377972	96.92	519	16	0	15	533	2839757	2839239	0.0	 902
HABJ36W02EXF44	FQ312003_650377972	92.00	25	2	0	219	243	2843672	2843648	5.8	34.2
HABJ36W02EXF44	CP002487_650377971	96.92	519	16	0	15	533	2839757	2839239	0.0	 902
HABJ36W02EXF44	CP002487_650377971	92.00	25	2	0	219	243	2843672	2843648	5.8	34.2
HABJ36W02EXF44	CP001363_646862340	96.92	519	16	0	15	533	2882486	2881968	0.0	 902
HABJ36W02EXF44	CP001363_646862340	92.00	25	2	0	219	243	2886401	2886377	5.8	34.2
HABJ36W02EXF44	FN424405_646862339	96.92	519	16	0	15	533	2855226	2854708	0.0	 902
HABJ36W02EXF44	FN424405_646862339	92.00	25	2	0	219	243	2859141	2859117	5.8	34.2
HABJ36W02EXF44	NZ_ABAO01000014_641736231	96.92	519	16	0	15	533	26581	26063	0.0	 902
HABJ36W02EXF44	NZ_ABAO01000014_641736231	92.00	25	2	0	219	243	30496	30472	5.8	34.2
HABJ36W02EXF44	NZ_ABEW01000002_641736111	97.09	515	15	0	19	533	676115	676629	0.0	 902
HABJ36W02EXF44	NZ_ABEW01000002_641736111	92.00	25	2	0	219	243	672196	672220	5.8	34.2
HABJ36W02EXF44	NC_003197_637000255	96.92	519	16	0	15	533	2828569	2828051	0.0	 902
HABJ36W02EXF44	NC_003197_637000255	92.00	25	2	0	219	243	2832484	2832460	5.8	34.2
HABJ36W02EXF44	NC_011080_642555157	96.89	515	16	0	19	533	2831029	2830515	0.0	 894
HABJ36W02EXF44	NZ_ABAM01000042_641736233	96.89	515	16	0	19	533	15168	15682	0.0	 894
HABJ36W02EXF44	NC_011274_643348573	96.34	519	19	0	15	533	2771551	2771033	0.0	 878
HABJ36W02EXF44	NC_011274_643348573	92.00	25	2	0	219	243	2775449	2775425	5.8	34.2
HABJ36W02EXF44	NC_011294_643348572	96.34	519	19	0	15	533	2780680	2780162	0.0	 878
HABJ36W02EXF44	NC_011294_643348572	92.00	25	2	0	219	243	2784595	2784571	5.8	34.2
HABJ36W02EXF44	NC_011205_642555155	96.34	519	19	0	15	533	2907459	2906941	0.0	 878
HABJ36W02EXF44	NC_011205_642555155	92.00	25	2	0	219	243	2911119	2911095	5.8	34.2
HABJ36W02EXF44	NZ_CAAV01002222_642979340	97.52	483	12	0	15	497	483	1	0.0	 862
HABJ36W02EXF44	NZ_CAAU01001271_642979341	97.16	422	12	0	15	436	422	1	0.0	 741
HABJ36W02EXF44	NC_010067_641228505	89.65	512	53	0	22	533	232344	232855	8e-169	 595
HABJ36W02EXF44	NC_010067_641228505	89.47	38	4	0	496	533	232848	232885	0.006	44.1
HABJ36W02EXF44	NZ_CAAY01007054_642979347	97.30	222	6	0	155	376	1	222	6e-108	 392
HABJ36W02EXF44	NC_015761_650716084	84.24	514	81	0	15	528	2637016	2636503	3e-103	 377
HABJ36W02EXF44	NC_015761_650716084	100.00	17	0	0	350	366	803306	803322	5.8	34.2
HABJ36W02EXF44	NZ_CAAY01006869_642979347	97.67	172	3	1	15	186	171	1	2e-80	 301
HABJ36W02EXF44	NZ_CAAY01000619_642979347	96.53	173	4	2	363	533	4	176	6e-74	 280
HABJ36W02EXF44	NZ_CAAU01000697_642979341	100.00	114	0	0	420	533	671	558	8e-58	 226
HABJ36W02EXF44	NZ_CAAV01000955_642979340	100.00	36	0	0	498	533	1	36	3e-11	71.9
HABJ36W02EXF44	NZ_CAAT01000294_642979342	100.00	18	0	0	17	34	184	201	1.5	36.2
HABJ36W02EXF44	NZ_CAAY01006681_642979347	92.00	25	2	0	219	243	1397	1421	5.8	34.2
HABJ36W02EXF44	NZ_CAAQ01004079_642979345	92.00	25	2	0	219	243	424	448	5.8	34.2
HABJ36W02EXF44	NZ_CAAS01001556_642979343	92.00	25	2	0	219	243	1903	1879	5.8	34.2
HABJ36W02EXF44	NZ_CAAU01000937_642979341	92.00	25	2	0	219	243	498	474	5.8	34.2
HABJ36W02EXF44	NZ_CAAV01003243_642979340	92.00	25	2	0	219	243	224	200	5.8	34.2
HABJ36W02EXF44	NC_011148_642555154	100.00	17	0	0	29	45	14654	14670	5.8	34.2
HABJ36W02EXF44	NZ_ABAN01000064_641736230	95.24	21	1	0	53	73	4697	4677	5.8	34.2
HABJ36W02EXF44	NZ_ABFF01000064_641736209	95.24	21	1	0	53	73	76	96	5.8	34.2
HABJ36W02EXF44	NZ_ABFF01000026_641736209	95.24	21	1	0	53	73	697	677	5.8	34.2
HABJ36W02EXF44	NZ_ABEH01000016_641736102	100.00	17	0	0	119	135	86146	86130	5.8	34.2
# BLASTN 2.2.22 [Sep-27-2009]
# Query: HABJ36W02DLDSY
# Database: Salmonella.contig.fna
# Fields: Query id, Subject id, % identity, alignment length, mismatches, gap openings, q. start, q. end, s. start, s. end, e-value, bit score
HABJ36W02DLDSY	NZ_ABEH01000005_641736102	99.22	512	1	3	16	525	178784	178274	0.0	 959
HABJ36W02DLDSY	CP002614_651053065	97.85	512	8	3	16	525	3304871	3304361	0.0	 904
HABJ36W02DLDSY	CP002614_651053065	100.00	20	0	0	359	378	2375551	2375532	0.094	40.1
HABJ36W02DLDSY	CP002614_651053065	100.00	18	0	0	83	100	1165454	1165437	1.5	36.2
HABJ36W02DLDSY	CP002614_651053065	100.00	17	0	0	394	410	558902	558886	5.8	34.2
HABJ36W02DLDSY	CP002614_651053065	100.00	17	0	0	168	184	2375741	2375725	5.8	34.2
HABJ36W02DLDSY	CP002614_651053065	100.00	17	0	0	397	413	3106862	3106846	5.8	34.2
HABJ36W02DLDSY	FQ312003_650377972	97.85	512	8	3	16	525	3359716	3359206	0.0	 904
HABJ36W02DLDSY	FQ312003_650377972	100.00	20	0	0	359	378	2373522	2373503	0.094	40.1
HABJ36W02DLDSY	FQ312003_650377972	100.00	18	0	0	83	100	1164141	1164124	1.5	36.2
HABJ36W02DLDSY	FQ312003_650377972	100.00	17	0	0	394	410	557696	557680	5.8	34.2
HABJ36W02DLDSY	FQ312003_650377972	100.00	17	0	0	168	184	2373712	2373696	5.8	34.2
HABJ36W02DLDSY	FQ312003_650377972	100.00	17	0	0	397	413	3160946	3160930	5.8	34.2
HABJ36W02DLDSY	CP002487_650377971	97.85	512	8	3	16	525	3359716	3359206	0.0	 904
HABJ36W02DLDSY	CP002487_650377971	100.00	20	0	0	359	378	2373522	2373503	0.094	40.1
HABJ36W02DLDSY	CP002487_650377971	100.00	18	0	0	83	100	1164141	1164124	1.5	36.2
HABJ36W02DLDSY	CP002487_650377971	100.00	17	0	0	394	410	557696	557680	5.8	34.2
HABJ36W02DLDSY	CP002487_650377971	100.00	17	0	0	168	184	2373712	2373696	5.8	34.2
HABJ36W02DLDSY	CP002487_650377971	100.00	17	0	0	397	413	3160946	3160930	5.8	34.2
HABJ36W02DLDSY	CP001363_646862340	97.85	512	8	3	16	525	3357264	3356754	0.0	 904
HABJ36W02DLDSY	CP001363_646862340	100.00	20	0	0	359	378	2427359	2427340	0.094	40.1
HABJ36W02DLDSY	CP001363_646862340	100.00	18	0	0	83	100	1166163	1166146	1.5	36.2
HABJ36W02DLDSY	CP001363_646862340	100.00	17	0	0	394	410	558902	558886	5.8	34.2
HABJ36W02DLDSY	CP001363_646862340	100.00	17	0	0	168	184	2427549	2427533	5.8	34.2
HABJ36W02DLDSY	CP001363_646862340	100.00	17	0	0	397	413	3159293	3159277	5.8	34.2
HABJ36W02DLDSY	FN424405_646862339	97.85	512	8	3	16	525	3330254	3329744	0.0	 904
HABJ36W02DLDSY	FN424405_646862339	100.00	20	0	0	359	378	2399472	2399453	0.094	40.1
HABJ36W02DLDSY	FN424405_646862339	100.00	18	0	0	83	100	1203786	1203769	1.5	36.2
HABJ36W02DLDSY	FN424405_646862339	100.00	17	0	0	394	410	598713	598697	5.8	34.2
HABJ36W02DLDSY	FN424405_646862339	100.00	17	0	0	168	184	2399662	2399646	5.8	34.2
HABJ36W02DLDSY	FN424405_646862339	100.00	17	0	0	397	413	3131494	3131478	5.8	34.2
HABJ36W02DLDSY	NZ_ABAK01000001_641736234	97.85	512	8	3	16	525	99259	99769	0.0	 904
HABJ36W02DLDSY	NZ_ABAK01000001_641736234	100.00	17	0	0	394	410	303366	303382	5.8	34.2
HABJ36W02DLDSY	NZ_ABAM01000014_641736233	97.85	512	8	3	16	525	66235	65725	0.0	 904
HABJ36W02DLDSY	NZ_ABAO01000002_641736231	97.85	512	8	3	16	525	123072	123582	0.0	 904
HABJ36W02DLDSY	NZ_ABFH01000014_641736185	97.85	512	8	3	16	525	33950	34460	0.0	 904
HABJ36W02DLDSY	NZ_ABEI01000008_641736103	97.85	512	8	3	16	525	65684	65174	0.0	 904
HABJ36W02DLDSY	NC_003197_637000255	97.85	512	8	3	16	525	3339012	3338502	0.0	 904
HABJ36W02DLDSY	NC_003197_637000255	100.00	20	0	0	359	378	2375806	2375787	0.094	40.1
HABJ36W02DLDSY	NC_003197_637000255	100.00	18	0	0	83	100	1207819	1207802	1.5	36.2
HABJ36W02DLDSY	NC_003197_637000255	100.00	17	0	0	394	410	558208	558192	5.8	34.2
HABJ36W02DLDSY	NC_003197_637000255	100.00	17	0	0	168	184	2375996	2375980	5.8	34.2
HABJ36W02DLDSY	NC_003197_637000255	100.00	17	0	0	397	413	3139484	3139468	5.8	34.2
HABJ36W02DLDSY	AP011957_651053064	97.66	512	9	3	16	525	3362276	3361766	0.0	 896
HABJ36W02DLDSY	AP011957_651053064	100.00	20	0	0	359	378	2371349	2371330	0.094	40.1
HABJ36W02DLDSY	AP011957_651053064	100.00	18	0	0	83	100	1205504	1205487	1.5	36.2
HABJ36W02DLDSY	AP011957_651053064	100.00	17	0	0	394	410	596255	596239	5.8	34.2
HABJ36W02DLDSY	AP011957_651053064	100.00	17	0	0	168	184	2371539	2371523	5.8	34.2
HABJ36W02DLDSY	AP011957_651053064	100.00	17	0	0	397	413	3162729	3162713	5.8	34.2"""

SECOND_DB = """# BLASTN 2.2.22 [Sep-27-2009]
# Query: HABJ36W02EXF44
# Database: Rest.contig.fna
# Fields: Query id, Subject id, % identity, alignment length, mismatches, gap openings, q. start, q. end, s. start, s. end, e-value, bit score
HABJ36W02EXF44	NZ_ADUJ01000844_649989992	96.00	25	1	0	139	163	5283	5259	1.2	42.1
HABJ36W02EXF44	NC_013716_646311913	96.00	25	1	0	350	374	2722205	2722181	1.2	42.1
HABJ36W02EXF44	NC_013421_646311947	90.62	32	3	0	220	251	3632712	3632681	4.6	40.1
HABJ36W02EXF44	NZ_ACKV01000049_643886109	100.00	20	0	0	345	364	13250	13269	4.6	40.1
HABJ36W02EXF44	NC_011369_643348569	95.83	24	1	0	149	172	505997	506020	4.6	40.1
HABJ36W02EXF44	NZ_ABRA01002405_642979303	100.00	20	0	0	207	226	1828	1809	4.6	40.1
HABJ36W02EXF44	NC_009480_640427108	100.00	20	0	0	122	141	2129655	2129674	4.6	40.1
HABJ36W02EXF44	NC_008531_639633034	100.00	20	0	0	345	364	1588655	1588674	4.6	40.1
HABJ36W02EXF44	NC_008751_639633022	100.00	20	0	0	366	385	2503240	2503221	4.6	40.1
HABJ36W02EXF44	NC_007778_637000240	100.00	20	0	0	116	135	4467356	4467337	4.6	40.1
HABJ36W02EXF44	NC_002937_637000096	100.00	20	0	0	366	385	913141	913160	4.6	40.1
# BLASTN 2.2.22 [Sep-27-2009]
# Query: HABJ36W02DLDSY
# Database: Rest.contig.fna
# Fields: Query id, Subject id, % identity, alignment length, mismatches, gap openings, q. start, q. end, s. start, s. end, e-value, bit score
HABJ36W02DLDSY	NZ_ACZD01000120_647000262	88.79	455	49	2	34	487	40604	41057	4e-133	 482
HABJ36W02DLDSY	CP002910_651053036	87.85	494	57	3	34	525	4266432	4265940	2e-132	 480
HABJ36W02DLDSY	CP002910_651053036	87.50	40	5	0	20	59	3419971	3419932	4.6	40.1
HABJ36W02DLDSY	FP929040_650377928	88.16	473	54	2	16	487	3290275	3289804	6e-132	 478
HABJ36W02DLDSY	NZ_AFBO01000526_651324045	88.57	455	50	2	34	487	2055	1602	9e-131	 474
HABJ36W02DLDSY	NC_012731_646564538	88.57	455	50	2	34	487	4512372	4511919	9e-131	 474
HABJ36W02DLDSY	NC_012731_646564538	87.50	40	5	0	20	59	3709405	3709366	4.6	40.1
HABJ36W02DLDSY	NC_009648_640753032	88.57	455	50	2	34	487	3763237	3762784	9e-131	 474
HABJ36W02DLDSY	NC_009648_640753032	87.50	40	5	0	20	59	2905451	2905412	4.6	40.1
HABJ36W02DLDSY	NC_014121_646564529	87.65	486	58	2	16	500	4455346	4454862	4e-130	 472
HABJ36W02DLDSY	NC_015663_650716035	87.47	495	59	3	34	526	741174	740681	2e-128	 466
HABJ36W02DLDSY	NC_015663_650716035	86.54	52	7	0	87	138	5164513	5164462	0.019	48.1
HABJ36W02DLDSY	NZ_GG657367_646206256	86.72	512	65	3	16	525	516392	515882	3e-124	 452
HABJ36W02DLDSY	NZ_AFHR01000063_651324029	87.04	486	61	2	16	500	300640	300156	5e-123	 448
HABJ36W02DLDSY	NC_013716_646311913	86.52	512	66	3	16	525	3757360	3756850	8e-122	 444
HABJ36W02DLDSY	NC_009792_640753015	86.25	509	67	3	16	522	4086169	4085662	1e-117	 430
HABJ36W02DLDSY	NZ_GG745510_647533174	87.03	455	57	2	34	487	528577	528124	5e-114	 418
HABJ36W02DLDSY	NZ_GG749175_647533159	86.72	467	60	2	16	481	209264	208799	5e-114	 418
HABJ36W02DLDSY	NC_013850_646311937	87.03	455	57	2	34	487	687416	687869	5e-114	 418
HABJ36W02DLDSY	NC_013850_646311937	87.50	40	5	0	20	59	1496052	1496091	4.6	40.1
HABJ36W02DLDSY	NC_011283_643348560	87.03	455	57	2	34	487	695679	696132	5e-114	 418
HABJ36W02DLDSY	NC_011283_643348560	87.50	40	5	0	20	59	1533365	1533404	4.6	40.1
HABJ36W02DLDSY	NC_014618_649633041	86.37	477	63	2	16	491	765797	766272	7e-113	 414
HABJ36W02DLDSY	NZ_ABWM01000071_642979368	86.37	477	63	2	16	491	103700	103225	7e-113	 414
HABJ36W02DLDSY	NZ_GG749335_647533160	85.74	512	70	3	16	525	440877	440367	3e-112	 412
HABJ36W02DLDSY	CP002729_651053024	86.51	467	61	2	16	481	3653359	3652894	1e-111	 410
HABJ36W02DLDSY	CP002890_651053023	86.51	467	61	2	16	481	3704336	3703871	1e-111	 410
HABJ36W02DLDSY	AP012030_651053020	86.51	467	61	2	16	481	3143687	3143222	1e-111	 410
HABJ36W02DLDSY	FN649414_650377932	86.51	467	61	2	16	481	3556743	3556278	1e-111	 410
HABJ36W02DLDSY	NZ_ADUK01000025_649989946	86.51	467	61	2	16	481	162250	162715	1e-111	 410
HABJ36W02DLDSY	NZ_GG774914_648861009	86.51	467	61	2	16	481	599587	599122	1e-111	 410
HABJ36W02DLDSY	NZ_ADTJ01000522_648276660	86.51	467	61	2	16	481	15217	14752	1e-111	 410
HABJ36W02DLDSY	NZ_ADTQ01000274_648276658	86.51	467	61	2	16	481	88573	88108	1e-111	 410
HABJ36W02DLDSY	NZ_ADTN01000023_648276654	86.51	467	61	2	16	481	24571	25036	1e-111	 410
HABJ36W02DLDSY	NZ_ADTL01000069_648276650	86.51	467	61	2	16	481	25699	26164	1e-111	 410
HABJ36W02DLDSY	NZ_ADAW01000125_648276648	86.51	467	61	2	16	481	58431	57966	1e-111	 410
HABJ36W02DLDSY	NZ_ADAU01000100_648276645	86.51	467	61	2	16	481	121482	121017	1e-111	 410
HABJ36W02DLDSY	NZ_GG749225_647533161	86.51	467	61	2	16	481	597298	596833	1e-111	 410
HABJ36W02DLDSY	CP001637_646862325	86.51	467	61	2	16	481	717983	718448	1e-111	 410
HABJ36W02DLDSY	CP001509_646862324	86.51	467	61	2	16	481	3033217	3032752	1e-111	 410
HABJ36W02DLDSY	AM946981_646862323	86.51	467	61	2	16	481	3032421	3031956	1e-111	 410
HABJ36W02DLDSY	NC_013941_646564533	86.51	467	61	2	16	481	3795884	3795419	1e-111	 410
HABJ36W02DLDSY	NC_000913_646311926	86.51	467	61	2	16	481	3163802	3163337	1e-111	 410
HABJ36W02DLDSY	NZ_ACXN01000044_645951861	86.51	467	61	2	16	481	30640	30175	1e-111	 410
HABJ36W02DLDSY	NZ_ACXO01000246_645951847	86.51	467	61	2	16	481	30641	30176	1e-111	 410
HABJ36W02DLDSY	NC_011751_644736365	86.51	467	61	2	16	481	3623538	3623073	1e-111	 410
HABJ36W02DLDSY	NC_013008_644736363	86.51	467	61	2	16	481	3965254	3964789	1e-111	 410
HABJ36W02DLDSY	NC_012759_644736362	86.51	467	61	2	16	481	3050950	3050485	1e-111	 410
HABJ36W02DLDSY	NC_012947_644736361	86.51	467	61	2	16	481	740587	741052	1e-111	 410
HABJ36W02DLDSY	NC_012967_644736359	86.51	467	61	2	16	481	3099952	3099487	1e-111	 410
HABJ36W02DLDSY	NC_011353_643348549	86.51	467	61	2	16	481	4009213	4008748	1e-111	 410
HABJ36W02DLDSY	NC_011750_643348547	86.51	467	61	2	16	481	3670295	3669830	1e-111	 410
HABJ36W02DLDSY	NZ_ABKY02000002_642979322	86.51	467	61	2	16	481	256401	256866	1e-111	 410
HABJ36W02DLDSY	NZ_ABJT01000011_642791630	86.51	467	61	2	16	481	75257	74792	1e-111	 410
HABJ36W02DLDSY	NZ_ABHW01000002_641736226	86.51	467	61	2	16	481	111955	111490	1e-111	 410
HABJ36W02DLDSY	NZ_ABHT01000002_641736225	86.51	467	61	2	16	481	214152	213687	1e-111	 410
HABJ36W02DLDSY	NZ_ABHU01000003_641736224	86.51	467	61	2	16	481	214396	213931	1e-111	 410
HABJ36W02DLDSY	NZ_ABHS01000003_641736222	86.51	467	61	2	16	481	271568	271103	1e-111	 410
HABJ36W02DLDSY	NZ_ABHP01000003_641736221	86.51	467	61	2	16	481	35442	35907	1e-111	 410
HABJ36W02DLDSY	NZ_ABHQ01000011_641736220	86.51	467	61	2	16	481	113101	112636	1e-111	 410
HABJ36W02DLDSY	NZ_ABHO01000003_641736214	86.51	467	61	2	16	481	161977	162442	1e-111	 410
HABJ36W02DLDSY	NZ_ABHL01000003_641736213	86.51	467	61	2	16	481	455455	454990	1e-111	 410
HABJ36W02DLDSY	NZ_ABHM01000002_641736212	86.51	467	61	2	16	481	162782	163247	1e-111	 410
HABJ36W02DLDSY	NZ_ABHK01000004_641736210	86.51	467	61	2	16	481	257846	258311	1e-111	 410
HABJ36W02DLDSY	NZ_ABHR01000002_641736116	86.51	467	61	2	16	481	210233	209768	1e-111	 410
HABJ36W02DLDSY	NC_010473_641522625	86.51	467	61	2	16	481	3261547	3261082	1e-111	 410
HABJ36W02DLDSY	NC_010468_641522623	86.51	467	61	2	16	481	728787	729252	1e-111	 410
HABJ36W02DLDSY	NC_009800_640753025	86.51	467	61	2	16	481	3210611	3210146	1e-111	 410
HABJ36W02DLDSY	NZ_AAKB01000004_638341083	86.51	467	61	2	16	481	18453	18918	1e-111	 410
HABJ36W02DLDSY	NZ_AAMK01000004_638341082	86.51	467	61	2	16	481	44239	44704	1e-111	 410
HABJ36W02DLDSY	NC_004337_637000264	86.51	467	61	2	16	481	3161221	3160756	1e-111	 410
HABJ36W02DLDSY	NC_004741_637000263	86.51	467	61	2	16	481	3149884	3149419	1e-111	 410
HABJ36W02DLDSY	AC_000091_637000110	86.51	467	61	2	16	481	3164436	3163971	1e-111	 410
HABJ36W02DLDSY	NC_002695_637000108	86.51	467	61	2	16	481	3906131	3905666	1e-111	 410
HABJ36W02DLDSY	NC_002655_637000107	86.51	467	61	2	16	481	3973445	3972980	1e-111	 410
HABJ36W02DLDSY	NZ_ADBA01000109_648276671	86.26	473	63	2	16	487	217485	217014	2e-110	 406
HABJ36W02DLDSY	NC_014837_649633081	85.95	484	66	2	16	498	3713332	3712850	7e-110	 404
HABJ36W02DLDSY	NC_014837_649633081	100.00	24	0	0	364	387	2964534	2964511	0.019	48.1
HABJ36W02DLDSY	NC_014837_649633081	90.62	32	3	0	24	55	2964870	2964839	4.6	40.1
HABJ36W02DLDSY	NC_014306_649633042	85.71	504	69	3	16	517	4263043	4262541	7e-110	 404
HABJ36W02DLDSY	NC_014306_649633042	93.33	30	2	0	36	65	3417330	3417301	0.29	44.1"""


if __name__ == "__main__":
    main()
